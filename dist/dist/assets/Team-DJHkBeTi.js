import{j as e,d as M,e as w,r as n,f as N,g as k,h as S,i as C,k as A,F as P}from"./index-BPYl9JkP.js";import{B as b}from"./Button-Ao4J6QCP.js";import{P as F}from"./Pagination-CkBJZhi4.js";const U=({role:t})=>e.jsx("span",{className:"inline-flex items-center px-3 py-2 rounded-lg text-sm font-medium text-primary-purple bg-primary-purple/10",children:t}),$=({status:t})=>{const a={Active:"text-emerald-700 bg-emerald-100",Inactive:"text-rose-700 bg-rose-100",Pending:"text-amber-700 bg-amber-100"}[t]||"text-gray-700 bg-gray-100";return e.jsx("span",{className:`inline-flex items-center px-3 py-2 rounded-lg text-sm font-medium ${a}`,children:t})},_=({member:t,onEdit:s,onDelete:a})=>e.jsxs("div",{className:"grid grid-cols-[0.6fr_2fr_1.8fr_1.2fr_1.2fr_1fr] items-center bg-white rounded-2xl px-6 py-3 border border-black/5 shadow-sm",children:[e.jsx("div",{className:"font-medium text-gray-700 text-sm",children:t.id}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:t.avatar,alt:`${t.name} avatar`,className:"h-8 w-8 rounded-full object-cover"}),e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:t.name})]}),e.jsx("div",{className:"text-gray-600 text-sm",children:t.email}),e.jsx("div",{children:e.jsx(U,{role:t.role})}),e.jsx("div",{children:e.jsx($,{status:t.status})}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pr-3",children:[e.jsx("button",{type:"button",className:"text-primary-purple hover:opacity-80","aria-label":"Edit",onClick:()=>s?.(t),children:e.jsx(M,{})}),e.jsx("button",{type:"button",className:"text-primary-purple hover:opacity-80","aria-label":"Delete",onClick:()=>a?.(t),children:e.jsx(w,{})})]})]}),I="/api",z=({open:t,member:s,onClose:a,onSave:p})=>{const[r,c]=n.useState(""),[x,i]=n.useState(!1);if(n.useEffect(()=>{t&&s&&(c(s.name??""),i(!1))},[t,s]),!t||!s)return null;const d=async()=>{const l=localStorage.getItem("accessToken")||"";if(l)try{i(!0);const o=new FormData;o.append("id",s.id),o.append("name",r.trim());const m=await fetch(`${I}/auth/employees/`,{method:"PUT",headers:{Authorization:`Bearer ${l}`},body:o});if(!m.ok){console.error("[EditMember] PUT failed:",m.status,await m.text()),i(!1);return}a(),await p()}catch(o){console.error("[EditMember] PUT error:",o)}finally{i(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/30 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-3xl shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-primary-blue",children:"Edit Member"}),e.jsx("button",{onClick:a,"aria-label":"Close",className:"h-8 w-8 rounded-full border grid place-items-center hover:bg-gray-100",children:e.jsx(N,{className:"text-primary-purple"})})]}),e.jsxs("div",{className:"px-6 pb-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-primary-blue font-medium mb-2",children:"Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-primary-purple",children:e.jsx(k,{className:"h-5 w-5"})}),e.jsx("input",{type:"text",value:r,onChange:l=>c(l.target.value),placeholder:"Enter name",className:"w-full pl-14 pr-4 py-4 rounded-full border text-sm text-gray-800 outline-none focus:ring-2 focus:ring-primary-blue/20"})]})]}),e.jsx(b,{text:x?"Updating...":"Update",fullWidth:!0,py:"py-4",mt:"mt-0",onClick:d,disabled:x||!r.trim()})]})]})})},B="/api",O=({open:t,member:s,onClose:a})=>{const{loadTeam:p}=S(),[r,c]=n.useState(!1);if(!t||!s)return null;const x=async()=>{const i=localStorage.getItem("accessToken")||"";if(i)try{c(!0);const d=await fetch(`${B}/auth/employees/?id=${encodeURIComponent(s.id)}`,{method:"DELETE",headers:{Authorization:`Bearer ${i}`,Accept:"application/json"}});if(!d.ok){console.error("[DeleteMember] failed:",d.status,await d.text()),c(!1);return}await p(),a()}catch(d){console.error("[DeleteMember] error:",d)}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/30 backdrop-blur-[1px] p-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-3xl shadow-xl relative",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 pt-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-primary-blue",children:"Delete Member"}),e.jsx("button",{onClick:a,"aria-label":"Close",className:"h-8 w-8 rounded-full bg-white border grid place-items-center",children:e.jsx(N,{className:"text-primary-purple"})})]}),e.jsxs("div",{className:"px-6 pb-6 pt-4",children:[e.jsxs("div",{className:"flex items-start gap-3 py-3",children:[e.jsx("span",{className:"h-10 w-10 rounded-xl bg-rose-50 text-rose-600 grid place-items-center",children:e.jsx(w,{})}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Do you want to delete ",e.jsx("span",{className:"font-semibold text-[#0b0d3b]",children:s.name}),"? This action cannot be undone."]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(b,{text:r?"Deleting...":"Delete",fullWidth:!0,mt:"mt-0",py:"py-2 sm:py-3",className:"bg-rose-500 text-white hover:opacity-95",onClick:x,disabled:r})})]})]})})},R="/api",W=({open:t,onClose:s})=>{const[a,p]=n.useState(""),[r,c]=n.useState(""),[x,i]=n.useState(!1);if(!t)return null;const d=async()=>{if(!(!a.trim()||!r.trim())){i(!0);try{const l=localStorage.getItem("accessToken"),o=new FormData;o.append("name",a.trim()),o.append("email",r.trim());const m=await fetch(`${R}/auth/employees/`,{method:"POST",headers:{Authorization:l?`Bearer ${l}`:""},body:o}),u=await m.text();let h=null;try{h=u?JSON.parse(u):null}catch{}if(console.log("[send-invite] status:",m.status,m.statusText),console.log("[send-invite] response:",h??u),!m.ok)return;s(),p(""),c("")}catch(l){console.error("[send-invite] error:",l),alert("Error sending invite")}finally{i(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/30 backdrop-blur-[1px] p-4",children:e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-3xl shadow-xl relative",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-6",children:[e.jsx("h3",{className:"text-2xl font-semibold text-primary-blue",children:"Add Member"}),e.jsx("button",{onClick:s,"aria-label":"Close",className:"h-8 w-8 rounded-full bg-white border border-black/5 shadow-sm grid place-items-center hover:shadow transition",children:e.jsx(N,{className:"text-primary-purple"})})]}),e.jsxs("div",{className:"px-6 pb-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-primary-blue font-medium mb-2",children:"Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-primary-purple",children:e.jsx(k,{className:"h-5 w-5"})}),e.jsx("input",{type:"text",placeholder:"John Smith",value:a,onChange:l=>p(l.target.value),className:"w-full pl-14 pr-4 py-5 rounded-full bg-white border border-gray-200 text-xs text-gray-800 placeholder-gray-400 outline-none focus:ring-2 focus:ring-primary-blue/20 focus:border-primary-blue/50"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-primary-blue font-medium mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-primary-purple",children:e.jsx(C,{className:"h-5 w-5"})}),e.jsx("input",{type:"email",placeholder:"email@example.com",value:r,onChange:l=>c(l.target.value),className:"w-full pl-14 pr-4 py-5 rounded-full bg-white border border-gray-200 text-xs text-gray-800 placeholder-gray-400 outline-none focus:ring-2 focus:ring-primary-blue/20 focus:border-primary-blue/50"})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx(b,{text:x?"Sending...":"Send Invite",fullWidth:!0,py:"py-5",mt:"mt-0",onClick:d,disabled:x})})]})]})})},q=()=>{const{membersFromApi:t,loading:s,error:a,loadTeam:p}=S(),[r,c]=n.useState(1),[x,i]=n.useState(!1),[d,l]=n.useState(!1),[o,m]=n.useState(null),[u,h]=n.useState(!1),[T,E]=n.useState(null),j=8,v=(r-1)*j,y=t.slice(v,v+j),D=Math.max(1,Math.ceil(t.length/j));return e.jsxs("div",{className:"p-6 flex flex-col min-h-screen",children:[e.jsxs("div",{className:"flex items-center justify-between pb-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-primary-blue",children:"Team Management"}),e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx(b,{text:"Add Member",py:"py-2 sm:py-3",mt:"mt-0",fullWidth:!1,onClick:()=>i(!0)}),e.jsx("button",{className:"h-10 w-10 rounded-xl bg-white border border-black/5 shadow-sm flex items-center justify-center",children:e.jsx(A,{className:"text-primary-purple text-lg"})}),e.jsx("button",{className:"h-10 w-10 rounded-xl bg-white border border-black/5 shadow-sm flex items-center justify-center",children:e.jsx(P,{className:"text-primary-purple text-lg"})})]})]}),s&&e.jsx("p",{className:"text-sm text-gray-600",children:"Loading team..."}),a&&e.jsx("p",{className:"text-sm text-red-500",children:a}),e.jsxs("div",{className:"flex-1 flex flex-col space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-[0.6fr_2fr_1.8fr_1.2fr_1.2fr_1fr] px-6 py-3 text-xs sm:text-sm font-semibold text-gray-600 bg-gray-50 rounded-xl",children:[e.jsx("div",{children:"ID"}),e.jsx("div",{children:"Name"}),e.jsx("div",{children:"Email"}),e.jsx("div",{children:"Role"}),e.jsx("div",{children:"Status"}),e.jsx("div",{className:"text-right pr-3",children:"Actions"})]}),e.jsx("div",{className:"space-y-2",children:y.length===0&&!s?e.jsx("div",{className:"text-sm p-8 text-center text-gray-500",children:"No team members found."}):y.map(f=>e.jsx(_,{member:f,onEdit:g=>{m(g),l(!0)},onDelete:g=>{E(g),h(!0)}},f.id))})]}),y.length>0&&!s&&e.jsx("div",{className:"mt-auto pt-6 flex justify-end",children:e.jsx(F,{current:r,totalPages:D,onChange:f=>c(f)})}),e.jsx(z,{open:d,member:o,onClose:()=>l(!1),onSave:async()=>{await p()}}),e.jsx(O,{open:u,member:T,onClose:()=>h(!1)}),e.jsx(W,{open:x,onClose:()=>i(!1)})]})};export{q as default};
